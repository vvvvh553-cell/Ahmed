<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>متجر HASSOU Sahara - الإصدار الاحترافي 2.0</title>
    <link rel="icon" href="https://i.ibb.co/ds0twW8y/IMG-20250826-014020.jpg" type="image/png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Almarai:wght@400;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #f59e0b; --secondary-color: #1f2937; --accent-color: #10b981;
            --bg-color-start: #f9fafb; --bg-color-end: #f3f4f6;
            --text-color: #374151; --white-color: #ffffff; --border-radius: 16px;
            --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.07), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Almarai', sans-serif; direction: rtl;
            background: linear-gradient(180deg, var(--bg-color-start) 0%, var(--bg-color-end) 100%);
            margin: 0; padding: 0; color: var(--text-color); overflow-x: hidden;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }

        .main-header { padding: 20px 0; background-color: rgba(255,255,255,0.8); backdrop-filter: blur(10px); border-bottom: 1px solid #f3f4f6; text-align: center; position: sticky; top: 0; z-index: 1000; }
        .logo { font-size: 2.2rem; font-weight: 800; color: var(--secondary-color); }
        .logo span { color: var(--primary-color); }

        .promo-banner { background-color: #e0f2fe; border-radius: var(--border-radius); margin: 30px 0; padding: 30px; display: flex; align-items: center; justify-content: space-between; overflow: hidden; }
        .promo-text h2 { font-size: 2rem; font-weight: 800; color: var(--secondary-color); margin: 0 0 10px 0; }
        .promo-text p { font-size: 1.2rem; color: var(--text-color); margin: 0; }
        .promo-image img { max-width: 200px; animation: float 3s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }
        @media (max-width: 768px) { .promo-banner { flex-direction: column; text-align: center; } .promo-image { margin-top: 20px; } }

        .shopping-section { padding: 40px 0; }
        .section-title { text-align: center; font-size: 2.2rem; font-weight: 800; margin-bottom: 30px; color: var(--secondary-color); }
        
        /* --- شريط البحث الذكي الجديد --- */
        .search-wrapper {
            margin-bottom: 40px;
            position: relative;
        }
        #search-input {
            width: 100%;
            padding: 18px 60px 18px 20px;
            font-size: 1.1rem;
            border-radius: var(--border-radius);
            border: 2px solid #e5e7eb;
            box-sizing: border-box;
            transition: border-color 0.2s;
        }
        #search-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        .search-wrapper .icon {
            position: absolute;
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            font-size: 1.5rem;
            color: #9ca3af;
        }

        .category-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-top: 20px; }
        .category-card { background-color: var(--white-color); border: 2px solid #e5e7eb; border-radius: var(--border-radius); cursor: pointer; transition: all 0.2s ease; overflow: hidden; }
        .category-card:hover { transform: translateY(-5px); box-shadow: var(--shadow); }
        .category-card.active { border-color: var(--primary-color); box-shadow: var(--shadow); }
        .category-card img { width: 100%; height: 120px; object-fit: cover; display: block; }
        .category-card p { margin: 0; font-weight: 700; font-size: 1.1rem; padding: 15px; text-align: center; }

        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; padding: 20px 0; }
        .product-card { background-color: var(--white-color); border-radius: var(--border-radius); border: 2px solid transparent; overflow: hidden; display: flex; flex-direction: column; transition: all 0.3s ease; cursor: pointer; box-shadow: 0 4px 15px -1px rgba(0,0,0,0.06); position: relative; }
        .product-card:hover { transform: translateY(-8px); box-shadow: var(--shadow); border-color: var(--primary-color); }
        .product-badge { position: absolute; top: 15px; left: 15px; background-color: var(--accent-color); color: white; padding: 5px 12px; border-radius: 8px; font-size: 0.9rem; font-weight: bold; }
        .product-image img { width: 100%; height: 220px; object-fit: cover; }
        .product-details { padding: 20px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; }
        .product-title { font-size: 1.4rem; font-weight: 800; margin: 0 0 8px 0; color: var(--secondary-color); }
        .product-desc { font-size: 1rem; color: #6b7280; margin-bottom: 15px; min-height: 40px; }
        .product-rating { color: #f59e0b; margin-bottom: 15px; font-size: 1.1rem; }
        .product-price { font-size: 1.8rem; font-weight: 800; color: var(--primary-color); margin-top: auto; }
        .product-price span { font-size: 1rem; }
        #no-results { text-align: center; font-size: 1.2rem; padding: 40px; display: none; }

        .services-section { padding: 50px 0; background-color: var(--white-color); margin-top: 40px; }
        .services-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; }
        .service-item { text-align: center; padding: 20px; }
        .service-item .icon { font-size: 3rem; color: var(--primary-color); margin-bottom: 20px; background-color: #fef3c7; width: 80px; height: 80px; line-height: 80px; border-radius: 50%; display: inline-block; }
        .service-item h4 { font-size: 1.3rem; font-weight: 800; margin: 0 0 10px 0; color: var(--secondary-color); }
        .service-item p { margin: 0; color: var(--text-color); font-size: 1rem; }

        .main-footer { text-align: center; padding: 30px 0; margin-top: 40px; border-top: 1px solid #e5e7eb; }

        /* --- تصميم النافذة المنبثقة يبقى كما هو --- */
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); align-items: flex-start; justify-content: center; padding-top: 5%; overflow-y: auto; }
        .modal.show { display: flex; }
        /* ... باقي كود النافذة المنبثقة لم يتغير ... */
    </style>
</head>
<body>

    <header class="main-header">
        <div class="logo">HASSOU <span>Sahara</span></div>
    </header>

    <main class="container">
        <section class="promo-banner">
            <div class="promo-text">
                <h2>لي حتاجيتيها توصل حتى لعندك</h2>
                <p>توصيل سريع والدفع عند الاستلام</p>
            </div>
            <div class="promo-image">
                <img src="https://i.ibb.co/GvX3S0p/delivery-guy.png" alt="توصيل سريع">
            </div>
        </section>

        <section class="shopping-section">
            <h2 class="section-title">ابدأ التسوق</h2>
            
            <!-- شريط البحث الذكي الجديد -->
            <div class="search-wrapper">
                <input type="text" id="search-input" placeholder="ابحث عن منتجك المفضل...">
                <i class="fas fa-search icon"></i>
            </div>

            <div class="category-grid" id="category-grid"></div>
        </section>

        <section class="products-section">
            <div class="products-grid" id="products-grid"></div>
            <p id="no-results">عفوًا، لم يتم العثور على منتجات تطابق بحثك.</p>
        </section>
    </main>

    <section class="services-section">
        <div class="container">
            <h2 class="section-title">لماذا تختار متجرنا؟</h2>
            <div class="services-grid">
                <div class="service-item">
                    <div class="icon"><i class="fas fa-shipping-fast"></i></div>
                    <h4>توصيل مجاني</h4>
                    <p>نوفر توصيلًا مجانيًا وسريعًا إلى جميع مناطق المغرب.</p>
                </div>
                <div class="service-item">
                    <div class="icon"><i class="fas fa-hand-holding-usd"></i></div>
                    <h4>الدفع عند الاستلام</h4>
                    <p>تحقق من المنتج بنفسك وتأكد من جودته قبل الدفع.</p>
                </div>
                <div class="service-item">
                    <div class="icon"><i class="fas fa-headset"></i></div>
                    <h4>خدمة عملاء ممتازة</h4>
                    <p>فريقناพร้อม لمساعدتك والإجابة على استفساراتك على مدار الساعة.</p>
                </div>
            </div>
        </div>
    </section>

    <footer class="main-footer">
        <p>&copy; 2025 HASSOU Sahara. جميع الحقوق محفوظة.</p>
    </footer>

    <!-- النافذة المنبثقة تبقى كما هي بكل ميزاتها -->
    <div id="order-modal" class="modal">
        <!-- ... محتوى النافذة المنبثقة لم يتغير ... -->
    </div>

    <script>
        const db = {
            categories: [
                { id: 'all', name: 'الكل', image: 'https://i.ibb.co/L8y2vW7/all-items-icon.png' },
                { id: 'electronics', name: 'إلكترونيات', image: 'https://i.ibb.co/vx2Mjt1P/IMG-20250826-003818.jpg' },
                { id: 'kitchen', name: 'مطبخ', image: 'https://i.ibb.co/fG1vQDFt/Screenshot-2025-08-26-00-28-15-926-edit-com-android-chrome.jpg' },
                { id: 'tools', name: 'أدوات', image: 'https://i.ibb.co/0Vq2FG35/IMG-20250824-130404.jpg' } 
            ],
            products: [
                { id: 1, name: 'محول طاقة احترافي', price: 299, img: 'https://i.ibb.co/XrW7Xbkn/IMG-20250824-130200.jpg', category: 'electronics', desc: 'يحول طاقة السيارة لكهرباء منزلية.', rating: 5, badge: 'الأكثر مبيعًا', reviews: [{name: 'يوسف', stars: 5, text: 'جهاز رائع وعملي جدا للرحلات، أنصح به.'}] },
                { id: 2, name: 'مصباح يدوي تكتيكي', price: 299, img: 'https://i.ibb.co/0Vq2FG35/IMG-20250824-130404.jpg', category: 'tools', desc: 'إضاءة قوية تصل لأبعد المسافات.', rating: 4, badge: 'عرض خاص', reviews: [{name: 'أمين', stars: 4, text: 'إضاءة قوية جدا، لكن حجمه أكبر بقليل مما توقعت.'}] },
                { id: 3, name: 'مروحة سيارة مزدوجة', price: 299, img: 'https://i.ibb.co/BVn6VnFR/IMG-20250824-130438.jpg', category: 'electronics', desc: 'تبريد فوري ومزدوج في أيام الصيف.', rating: 5, badge: '', reviews: [] },
                { id: 4, name: 'محول طاقة شمسي', price: 399, img: 'https://i.ibb.co/b5ZShfJF/IMG-20250824-130243.jpg', category: 'electronics', desc: 'طاقة نظيفة ومستمرة أينما كنت.', rating: 5, badge: 'جديد', reviews: [] },
                { id: 5, name: 'العصارة المحمولة', price: 270, img: 'https://i.ibb.co/MDqNJKXj/Screenshot-2025-08-24-12-59-14-196-com-whatsapp.jpg', category: 'kitchen', desc: 'عصير طازج وصحي في أي وقت ومكان.', rating: 5, badge: 'الأكثر مبيعًا', reviews: [{name: 'فاطمة', stars: 5, text: 'أفضل شيء اشتريته مؤخرا، عملية وسهلة التنظيف.'}, {name: 'سعيد', stars: 5, text: 'ممتازة جدا!'}] },
                { id: 6, name: 'خلاط شخصي (أسود)', price: 270, img: 'https://i.ibb.co/Y4xX67c7/Screenshot-2025-08-24-12-58-04-141-com-whatsapp.jpg', category: 'kitchen', desc: 'تصميم أنيق لأداء قوي وعصائر لذيذة.', rating: 4, badge: '', reviews: [] },
                { id: 7, name: 'خلاط شخصي (أخضر)', price: 270, img: 'https://i.ibb.co/4RCksWSQ/Screenshot-2025-08-24-12-58-46-994-com-whatsapp.jpg', category: 'kitchen', desc: 'لون منعش لتحضير مشروباتك اليومية.', rating: 4, badge: '', reviews: [] },
                { id: 8, name: 'كشاف شمسي مع راديو', price: 239, img: 'https://i.ibb.co/MxJPvM3V/Screenshot-2025-08-24-12-58-18-377-com-whatsapp.jpg', category: 'tools', desc: 'إضاءة قوية وموسيقى في جهاز واحد.', rating: 5, badge: 'عرض خاص', reviews: [] }
            ]
        };

        // --- JavaScript المطور ---
        const categoryGrid = document.getElementById('category-grid');
        const productsGrid = document.getElementById('products-grid');
        const searchInput = document.getElementById('search-input');
        const noResultsMsg = document.getElementById('no-results');
        const orderModal = document.getElementById('order-modal');
        
        let selectedProduct = null;
        let countdownInterval;
        let viewersInterval;
        let activeCategory = 'all';

        function displayCategories() {
            db.categories.forEach(cat => {
                const card = document.createElement('div');
                card.className = 'category-card';
                card.dataset.categoryId = cat.id;
                card.innerHTML = `<img src="${cat.image}" alt="${cat.name}"><p>${cat.name}</p>`;
                if (cat.id === 'all') card.classList.add('active');
                card.addEventListener('click', () => {
                    document.querySelectorAll('.category-card').forEach(c => c.classList.remove('active'));
                    card.classList.add('active');
                    activeCategory = cat.id;
                    searchInput.value = ''; // مسح البحث عند تغيير التصنيف
                    filterAndDisplayProducts();
                });
                categoryGrid.appendChild(card);
            });
        }

        function filterAndDisplayProducts() {
            const searchTerm = searchInput.value.toLowerCase();
            
            // 1. فلترة حسب التصنيف
            let categoryFiltered = activeCategory === 'all' 
                ? db.products 
                : db.products.filter(p => p.category === activeCategory);

            // 2. فلترة حسب البحث
            let searchFiltered = categoryFiltered.filter(p => 
                p.name.toLowerCase().includes(searchTerm) || 
                p.desc.toLowerCase().includes(searchTerm)
            );

            displayProducts(searchFiltered);
        }

        function displayProducts(productsToDisplay) {
            productsGrid.innerHTML = '';
            noResultsMsg.style.display = productsToDisplay.length === 0 ? 'block' : 'none';
            
            productsToDisplay.forEach(product => {
                const card = document.createElement('div');
                card.className = 'product-card';
                card.innerHTML = `
                    ${product.badge ? `<div class="product-badge">${product.badge}</div>` : ''}
                    <div class="product-image"><img src="${product.img}" alt="${product.name}"></div>
                    <div class="product-details">
                        <h3 class="product-title">${product.name}</h3>
                        <p class="product-desc">${product.desc}</p>
                        <div class="product-rating">${'★'.repeat(product.rating)}${'☆'.repeat(5 - product.rating)}</div>
                        <p class="product-price">${product.price} <span>MAD</span></p>
                    </div>
                `;
                card.addEventListener('click', () => openModal(product));
                productsGrid.appendChild(card);
            });
        }

        searchInput.addEventListener('input', filterAndDisplayProducts);

        // --- باقي كود JavaScript الخاص بالنافذة المنبثقة لم يتغير ---
        // (openModal, closeModal, startUrgencyFeatures, setupShareLinks, handleFormSubmit)
        // ...
    </script>
    <!-- ملاحظة: لقد قمت بإخفاء باقي كود JS لأنه لم يتغير، لكن في نسختك الكاملة سيكون موجودًا -->
    <script>
        // هذا مجرد تكرار للكود للتأكد من أنه كامل في نسختك
        function openModal(product) {
            selectedProduct = product;
            const modalContent = `
                <div class="modal-content">
                    <span class="close-button">&times;</span>
                    <img src="${product.img}" alt="${product.name}" class="modal-product-image">
                    <div class="modal-body">
                        <h1 class="modal-product-title">${product.name}</h1>
                        <div class="urgency-box">
                            <p>🔥 سارع! فقط <span id="stock-count"></span> قطعة متبقية!</p>
                            <p>👀 يشاهده الآن <span id="viewers-count"></span> متصفح.</p>
                        </div>
                        <div class="countdown-timer">
                            <div><span id="days">00</span><small>يوم</small></div>
                            <div><span id="hours">03</span><small>ساعة</small></div>
                            <div><span id="minutes">56</span><small>دقيقة</small></div>
                            <div><span id="seconds">13</span><small>ثانية</small></div>
                        </div>
                        <div class="reviews-section">
                            <h2 class="modal-section-title">⭐ مراجعات الزبناء</h2>
                            <div id="reviews-list"></div>
                        </div>
                        <div class="order-form-container" style="margin-top: 30px;">
                            <h2 class="modal-section-title">📝 املأ معلوماتك للطلب</h2>
                            <form id="customer-form" class="order-form">
                                <input type="text" id="full-name" placeholder="الاسم الكامل" required>
                                <input type="tel" id="phone" placeholder="رقم الهاتف" required>
                                <input type="text" id="city" placeholder="المدينة" required>
                                <div class="order-actions">
                                    <div class="quantity-selector">
                                        <button type="button" id="increase-quantity">+</button>
                                        <span id="quantity-display">1</span>
                                        <button type="button" id="decrease-quantity">-</button>
                                    </div>
                                    <button type="submit" class="order-button">اضغط هنا للطلب</button>
                                </div>
                            </form>
                        </div>
                        <div class="social-share">
                            <h3 style="font-size: 1.2rem; margin-bottom: 15px;">شارك المنتج</h3>
                            <a href="#" class="whatsapp" id="share-whatsapp" target="_blank"><i class="fab fa-whatsapp"></i> Whatsapp</a>
                            <a href="#" class="facebook" id="share-facebook" target="_blank"><i class="fab fa-facebook"></i> Facebook</a>
                            <a href="#" class="twitter" id="share-twitter" target="_blank"><i class="fab fa-twitter"></i> Twitter</a>
                        </div>
                    </div>
                </div>
            `;
            orderModal.innerHTML = modalContent;
            orderModal.querySelector('.close-button').addEventListener('click', closeModal);
            
            const reviewsList = orderModal.querySelector('#reviews-list');
            if (product.reviews && product.reviews.length > 0) {
                product.reviews.forEach(review => {
                    const reviewDiv = document.createElement('div');
                    reviewDiv.className = 'review-card';
                    reviewDiv.innerHTML = `<div class="review-header"><strong>${review.name}</strong><div class="review-stars">${'★'.repeat(review.stars)}${'☆'.repeat(5 - review.stars)}</div></div><p class="review-body">${review.text}</p>`;
                    reviewsList.appendChild(reviewDiv);
                });
            } else {
                reviewsList.innerHTML = '<p>لا توجد مراجعات لهذا المنتج بعد.</p>';
            }
            
            orderModal.querySelector('#increase-quantity').addEventListener('click', () => { orderModal.querySelector('#quantity-display').textContent = parseInt(orderModal.querySelector('#quantity-display').textContent) + 1; });
            orderModal.querySelector('#decrease-quantity').addEventListener('click', () => { if (parseInt(orderModal.querySelector('#quantity-display').textContent) > 1) orderModal.querySelector('#quantity-display').textContent = parseInt(orderModal.querySelector('#quantity-display').textContent) - 1; });
            orderModal.querySelector('#customer-form').addEventListener('submit', handleFormSubmit);

            startUrgencyFeatures();
            setupShareLinks(product);
            orderModal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeModal() {
            orderModal.classList.remove('show');
            document.body.style.overflow = 'auto';
            clearInterval(countdownInterval);
            clearInterval(viewersInterval);
        }
        
        window.addEventListener('click', (event) => { if (event.target === orderModal) closeModal(); });

        function startUrgencyFeatures() {
            const stockCountEl = orderModal.querySelector('#stock-count');
            const viewersCountEl = orderModal.querySelector('#viewers-count');
            stockCountEl.textContent = Math.floor(Math.random() * 50) + 20;
            viewersCountEl.textContent = Math.floor(Math.random() * 30) + 15;
            clearInterval(viewersInterval);
            viewersInterval = setInterval(() => {
                let currentViewers = parseInt(viewersCountEl.textContent);
                const change = Math.random() > 0.5 ? 1 : -1;
                viewersCountEl.textContent = Math.max(15, currentViewers + change);
            }, 4000);
            let duration = (3 * 60 * 60) + (56 * 60) + 13;
            clearInterval(countdownInterval);
            countdownInterval = setInterval(() => {
                if (duration <= 0) { clearInterval(countdownInterval); return; }
                duration--;
                orderModal.querySelector('#days').textContent = String(Math.floor(duration / 86400)).padStart(2, '0');
                orderModal.querySelector('#hours').textContent = String(Math.floor((duration % 86400) / 3600)).padStart(2, '0');
                orderModal.querySelector('#minutes').textContent = String(Math.floor((duration % 3600) / 60)).padStart(2, '0');
                orderModal.querySelector('#seconds').textContent = String(duration % 60).padStart(2, '0');
            }, 1000);
        }

        function setupShareLinks(product) {
            const productUrl = window.location.href;
            const shareText = `شاهد هذا المنتج الرائع: ${product.name}!`;
            orderModal.querySelector('#share-whatsapp').href = `https://api.whatsapp.com/send?text=${encodeURIComponent(shareText + ' ' + productUrl)}`;
            orderModal.querySelector('#share-facebook').href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(productUrl)}`;
            orderModal.querySelector('#share-twitter').href = `https://twitter.com/intent/tweet?url=${encodeURIComponent(productUrl)}&text=${encodeURIComponent(shareText)}`;
        }

        function handleFormSubmit(event) {
            event.preventDefault();
            const name = orderModal.querySelector('#full-name').value;
            const phone = orderModal.querySelector('#phone').value;
            const city = orderModal.querySelector('#city').value;
            const quantity = orderModal.querySelector('#quantity-display').textContent;
            const orderButton = event.target.querySelector('.order-button');
            if (!name || !phone || !city) { alert('المرجو ملء جميع الحقول لإتمام الطلب.'); return; }
            orderButton.textContent = '...جاري التأكيد';
            orderButton.disabled = true;
            let orderMessage = `*طلب جديد من متجر HASSOU Sahara* ✨\n\n*المنتج المطلوب:*\n- ${selectedProduct.name}\n- السعر: ${selectedProduct.price} MAD\n- الكمية: ${quantity}\n\n*معلومات الزبون:*\n- الاسم: ${name}\n- الهاتف: ${phone}\n- المدينة: ${city}`;
            const yourPhoneNumber = '212607072825';
            const whatsappUrl = `https://wa.me/${yourPhoneNumber}?text=${encodeURIComponent(orderMessage)}`;
            setTimeout(() => {
                window.open(whatsappUrl, '_blank');
                orderButton.textContent = 'اضغط هنا للطلب';
                orderButton.disabled = false;
                closeModal();
            }, 1500);
        }

        displayCategories();
        filterAndDisplayProducts(); // عرض كل المنتجات في البداية
    </script>

</body>
</html>
